<template>
  <div id="toolbar" class="no-select">
    <span class="ql-formats no-select">
      <Tooltip
       content="加粗"
       placement="bottom">
        <button class="ql-bold"></button>
      </Tooltip>
      <Tooltip
       content="斜体"
       placement="bottom">
        <button class="ql-italic"></button>
      </Tooltip>
      <Tooltip
       content="下划线"
       placement="bottom">
        <button class="ql-underline"></button>
      </Tooltip>
      <Tooltip
       content="删除线"
       placement="bottom">
        <button class="ql-strike"></button>
      </Tooltip>
      <Tooltip
       content="对齐"
       placement="right">
        <select class="ql-align"></select>
      </Tooltip>
    </span>

    <span class="ql-formats no-select">
      <Tooltip
       content="标题"
       placement="right">
        <select class="ql-header">
          <option selected></option>
          <option value="1"></option>
          <option value="2"></option>
          <option value="3"></option>
          <option value="4"></option>
          <option value="5"></option>
          <option value="6"></option>
        </select>
      </Tooltip>
      <Tooltip
       content="字体大小"
       placement="right">
        <select class="ql-size">
          <option value="small"></option>
          <option selected></option>
          <option value="large"></option>
          <option value="huge"></option>
        </select>
      </Tooltip>
      <Tooltip
       content="字体"
       placement="right">
        <select class="ql-font"></select>
      </Tooltip>
    </span>

    <span class="ql-formats no-select">
      <Tooltip
       content="下标"
       placement="bottom">
        <button class="ql-script" value="sub"></button>
      </Tooltip>
      <Tooltip
       content="上标"
       placement="bottom">
        <button class="ql-script" value="super"></button>
      </Tooltip>
    </span>
  
    <span class="ql-formats no-select">
      <Tooltip
       content="段落引用"
       placement="bottom">
        <button class="ql-blockquote"></button>
      </Tooltip>
      <Tooltip
       content="代码块"
       placement="bottom">
        <button class="ql-code-block"></button>
      </Tooltip>
      <Tooltip
       content="有序列表"
       placement="bottom">
        <button class="ql-list" value="ordered"></button>
      </Tooltip>
      <Tooltip
       content="无序列表"
       placement="bottom">
        <button class="ql-list" value="bullet"></button>
      </Tooltip>
      <Tooltip
       content="任务列表"
       placement="bottom">
        <button class="ql-list" value="check"></button>
      </Tooltip>
    </span>

    <span class="ql-formats no-select">
      <Tooltip
       content="缩进"
       placement="bottom">
        <button class="ql-indent" value="+1"></button>
      </Tooltip>
      <Tooltip
       content="删除缩进"
       placement="bottom">
        <button class="ql-indent" value="-1"></button>
      </Tooltip>
      <Tooltip
       content="右对齐"
       placement="bottom">
        <button class="ql-direction" value="rtl"></button>
      </Tooltip>
    </span>

    <span class="ql-formats no-select">
      <Tooltip
       content="字体颜色"
       placement="bottom">
        <select class="ql-color"></select>
      </Tooltip>
      <Tooltip
       content="背景颜色"
       placement="bottom">
        <select class="ql-background"></select>
      </Tooltip>
    </span>
    
    <span class="ql-formats no-select">
      <Tooltip
       content="插入公式 / LaTeX"
       placement="bottom">
        <button class="formula-plus" @click="onClickFormula">
          <svg viewBox="0 0 18 18"> <path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"></path> <rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"></rect> <path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"></path> </svg>
        </button>
      </Tooltip>
      <Tooltip
       content="插入链接"
       placement="bottom">
        <button class="ql-link"></button>
      </Tooltip>
      <Tooltip
       content="插入图片"
       placement="bottom">
        <button class="ql-image"></button>
      </Tooltip>
      <Tooltip
       content="插入视频"
       placement="bottom">
        <button class="ql-video"></button>
      </Tooltip>
      <Tooltip
       content="插入表情"
       placement="bottom">
        <button class="ql-emoji"></button>
      </Tooltip>
    </span>

    <span class="ql-formats no-select">
      <Tooltip
       content="清除格式"
       placement="bottom">
        <button class="ql-clean"></button>
      </Tooltip>
    </span>

    <span class="ql-formats no-select">
      <Tooltip
       content="撤销"
       placement="bottom">
        <button
         class="ivu-icon ivu-icon-ios-undo"
         style="font-size: 18px;"
         @click="onClickUndo"
        >
        </button>
      </Tooltip>
      <Tooltip
       content="重做"
       placement="bottom">
        <button
         class="ivu-icon ivu-icon-ios-redo"
         style="font-size: 18px;"
         @click="onClickRedo"
        >
        </button>
      </Tooltip>
    </span>

    <span class="ql-formats no-select">
      <Tooltip
       content="插入图表"
       placement="bottom">
        <button
         class="ivu-icon ivu-icon-md-stats"
         style="font-size: 18px;"
         @click="charts = true"
        >
        </button>
      </Tooltip>
      <chart-editor v-model="charts"></chart-editor>
    </span>

    <span class="ql-formats no-select">
      <Tooltip
       content="化学方程式"
       placement="bottom">
        <button
         class="ivu-icon ivu-icon-ios-flask"
         style="font-size: 18px;"
         @click="chem = true"
        >
        </button>
      </Tooltip>
      <chem-editor v-model="chem"></chem-editor>
    </span>
  </div>
</template>

<script>
import ChartEditor from './ChartEditor'
import ChemEditor from './ChemEditor'

export default {
  name: 'Toolbar',
  components: {
    ChartEditor,
    ChemEditor
  },
  data: () => {
    return {
      charts: false,
      chem: false
    }
  },
  methods: {
    onClickUndo (event) {
      if (window.editor && window.editor.history) {
        window.editor.history.undo()
      }
    },
    onClickRedo (event) {
      if (window.editor && window.editor.history) {
        window.editor.history.redo()
      }
    },
    onClickFormula (event) {
      this.$store.commit('setTooltip', {
        editor: 'richText',
        tooltip: 'formula'
      })
      window.mathField.latex('')
      if (window.cmFormulaEditor) {
        window.cmFormulaEditor.doc.setValue('')
      }
      window.mathField.focus()
    }
  }
}
</script>
